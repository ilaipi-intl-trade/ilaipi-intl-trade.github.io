import{y as N,q as R,v as _,g as o,c,o as f,x as M,z as P,s as S,i as b,A as Q,f as C,a as e,t as m,b as p,w as V,d as T,h as B,l as E,B as h}from"./CI8nEKj8.js";import{_ as D}from"./DY3ywVTS.js";import{u as F}from"./BorQrp_K.js";const $=N({__name:"Input",props:{class:{},defaultValue:{},modelValue:{}},emits:["update:modelValue"],setup(a,{emit:r}){const n=a,s=F(n,"modelValue",r,{passive:!0,defaultValue:n.defaultValue});return(d,u)=>R((f(),c("input",{"onUpdate:modelValue":u[0]||(u[0]=g=>S(s)?s.value=g:null),"data-slot":"input",class:M(o(P)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input shadow-xs flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base outline-none transition-[color,box-shadow] file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n.class))},null,2)),[[_,o(s)]])}}),A={class:"mb-6 flex items-center gap-4"},z={class:"h-16 w-16 overflow-hidden rounded-lg bg-gray-100 dark:bg-gray-800"},O=["src","alt"],H={class:"font-medium text-gray-900 dark:text-white"},I={class:"text-primary text-lg font-bold"},q={class:"mb-6"},L={class:"flex items-center gap-2"},Y=["disabled"],G={class:"mb-6 rounded-lg bg-gray-50 p-4 dark:bg-gray-800"},J={class:"flex justify-between text-sm text-gray-600 dark:text-gray-300"},K={class:"flex justify-between text-sm text-gray-600 dark:text-gray-300"},W={class:"flex justify-between font-semibold text-gray-900 dark:text-white"},X={key:0,class:"text-primary"},Z={key:1,class:"text-gray-500"},ee={class:"flex gap-3"},te={key:0},ae={key:1},ie={__name:"QuantityDialog",props:{isOpen:{type:Boolean,default:!1},bag:{type:Object,required:!0},defaultQuantity:{type:Number,default:100}},emits:["close","confirm"],setup(a,{emit:r}){const n=a,i=r,s=b(n.defaultQuantity),d=b(!1);Q(()=>n.isOpen,w=>{w&&(s.value=n.defaultQuantity)});const u=async()=>{if(!(s.value<0)){d.value=!0;try{i("confirm",n.bag,s.value),i("close")}finally{d.value=!1}}},g=()=>{i("close")},l=()=>{s.value+=50},y=()=>{s.value>=50?s.value-=50:s.value=0};return(w,t)=>a.isOpen?(f(),c("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center",onClick:g},[t[12]||(t[12]=e("div",{class:"absolute inset-0 bg-black/20"},null,-1)),e("div",{class:"relative z-10 w-full max-w-md rounded-lg bg-white p-6 shadow-xl dark:bg-gray-900",onClick:t[2]||(t[2]=B(()=>{},["stop"]))},[t[11]||(t[11]=e("h3",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-white"}," Add to Cart ",-1)),e("div",A,[e("div",z,[a.bag.images[0]?(f(),c("img",{key:0,src:a.bag.images[0].url,alt:a.bag.images[0].alt,class:"h-full w-full object-cover",loading:"lazy"},null,8,O)):C("",!0)]),e("div",null,[e("h4",H,m(a.bag.id)+" Handbag ",1),e("p",I,"짜"+m(a.bag.price),1)])]),e("div",q,[t[5]||(t[5]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Quantity ",-1)),e("div",L,[e("button",{onClick:y,class:"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 transition-colors hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700",disabled:o(s)<=0},[...t[3]||(t[3]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)])],8,Y),p(o($),{modelValue:o(s),"onUpdate:modelValue":t[0]||(t[0]=k=>S(s)?s.value=k:null),modelModifiers:{number:!0},type:"number",min:"0",class:"w-20 text-center",onInput:t[1]||(t[1]=k=>s.value=Math.max(0,parseInt(o(s))||0))},null,8,["modelValue"]),e("button",{onClick:l,class:"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 transition-colors hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700"},[...t[4]||(t[4]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)])])])]),e("div",G,[e("div",J,[t[6]||(t[6]=e("span",null,"Unit Price:",-1)),e("span",null,"짜"+m(a.bag.price),1)]),e("div",K,[t[7]||(t[7]=e("span",null,"Quantity:",-1)),e("span",null,m(o(s))+" pieces",1)]),t[9]||(t[9]=e("hr",{class:"my-2 border-gray-200 dark:border-gray-600"},null,-1)),e("div",W,[t[8]||(t[8]=e("span",null,"Total:",-1)),o(s)>0?(f(),c("span",X," 짜"+m((a.bag.price*o(s)).toLocaleString()),1)):(f(),c("span",Z,"짜0"))])]),e("div",ee,[p(o(D),{variant:"outline",class:"flex-1",onClick:g,disabled:o(d)},{default:V(()=>[...t[10]||(t[10]=[T(" Cancel ",-1)])]),_:1},8,["disabled"]),p(o(D),{class:"flex-1",onClick:u,disabled:o(d)||o(s)<=0},{default:V(()=>[o(d)?(f(),c("span",te,"Adding...")):(f(),c("span",ae,"Add to Cart"))]),_:1},8,["disabled"])])])])):C("",!0)}};let x=null,v=null;const se=3600*1e3;async function U(){if(x&&v&&Date.now()-v<se)return x;try{const a=await fetch("https://api.exchangerate-api.com/v4/latest/CNY");if(!a.ok)throw new Error("Failed to fetch exchange rate");const n=(await a.json()).rates.USD,i=n<1?1/n:n;return x=i,v=Date.now(),i}catch(a){console.warn("Failed to fetch real-time exchange rate, using fallback rate:",a);const r=7.2;return x=r,v=Date.now(),r}}async function j(a){const r=await U();return Number((a/r).toFixed(2))}async function ne(a){return`$${await j(a)}`}function de(){const a=b(null),r=b(!1),n=b(null),i=async()=>{if(!r.value){r.value=!0,n.value=null;try{const l=await U();a.value=l}catch(l){n.value=l instanceof Error?l.message:"Failed to fetch exchange rate",console.error("Exchange rate fetch error:",l)}finally{r.value=!1}}},s=async l=>await j(l),d=async l=>await ne(l),u=l=>a.value?Number((l/a.value).toFixed(2)):null,g=l=>{const y=u(l);return y?`$${y}`:null};return E(()=>{i()}),{exchangeRate:h(a),isLoading:h(r),error:h(n),fetchExchangeRate:i,convertToUSD:s,getUSDPrice:d,calculateUSDPrice:u,getFormattedUSDPriceSync:g}}export{ie as _,de as u};
