import{_ as U}from"./C-D6cZGj.js";import{y as R,q as B,v as M,g as l,c as g,o as c,x as P,z as Q,s as _,j as b,A as T,f as C,a as e,h as E,t as m,b as p,w as V,d as F,i as $,m as A,B as h}from"./BEqsmZh4.js";import{_ as D}from"./BHZ_2vj_.js";import{u as I}from"./BCvakJw5.js";const O=R({__name:"Input",props:{class:{},defaultValue:{},modelValue:{}},emits:["update:modelValue"],setup(a,{emit:r}){const n=a,s=I(n,"modelValue",r,{passive:!0,defaultValue:n.defaultValue});return(d,u)=>B((c(),g("input",{"onUpdate:modelValue":u[0]||(u[0]=f=>_(s)?s.value=f:null),"data-slot":"input",class:P(l(Q)("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input shadow-xs flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base outline-none transition-[color,box-shadow] file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",n.class))},null,2)),[[M,l(s)]])}}),z={class:"mb-6 flex items-center gap-4"},H={class:"h-16 w-16 overflow-hidden rounded-lg bg-gray-100 dark:bg-gray-800"},q={class:"font-medium text-gray-900 dark:text-white"},L={class:"text-primary text-lg font-bold"},Y={class:"mb-6"},G={class:"flex items-center gap-2"},J=["disabled"],K={class:"mb-6 rounded-lg bg-gray-50 p-4 dark:bg-gray-800"},W={class:"flex justify-between text-sm text-gray-600 dark:text-gray-300"},X={class:"flex justify-between text-sm text-gray-600 dark:text-gray-300"},Z={class:"flex justify-between font-semibold text-gray-900 dark:text-white"},ee={key:0,class:"text-primary"},te={key:1,class:"text-gray-500"},ae={class:"flex gap-3"},se={key:0},ne={key:1},ce={__name:"QuantityDialog",props:{isOpen:{type:Boolean,default:!1},bag:{type:Object,required:!0},defaultQuantity:{type:Number,default:100}},emits:["close","confirm"],setup(a,{emit:r}){const n=a,i=r,s=b(n.defaultQuantity),d=b(!1);T(()=>n.isOpen,w=>{w&&(s.value=n.defaultQuantity)});const u=async()=>{if(!(s.value<0)){d.value=!0;try{i("confirm",n.bag,s.value),i("close")}finally{d.value=!1}}},f=()=>{i("close")},o=()=>{s.value+=50},y=()=>{s.value>=50?s.value-=50:s.value=0};return(w,t)=>{const S=U;return a.isOpen?(c(),g("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center",onClick:f},[t[12]||(t[12]=e("div",{class:"absolute inset-0 bg-black/20"},null,-1)),e("div",{class:"relative z-10 w-full max-w-md rounded-lg bg-white p-6 shadow-xl dark:bg-gray-900",onClick:t[2]||(t[2]=$(()=>{},["stop"]))},[t[11]||(t[11]=e("h3",{class:"mb-4 text-lg font-semibold text-gray-900 dark:text-white"}," Add to Cart ",-1)),e("div",z,[e("div",H,[a.bag.images[0]?(c(),E(S,{key:0,src:a.bag.images[0].url,alt:a.bag.images[0].alt,class:"h-full w-full object-cover"},null,8,["src","alt"])):C("",!0)]),e("div",null,[e("h4",q,m(a.bag.id)+" Handbag ",1),e("p",L,"짜"+m(a.bag.price),1)])]),e("div",Y,[t[5]||(t[5]=e("label",{class:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300"}," Quantity ",-1)),e("div",G,[e("button",{onClick:y,class:"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 transition-colors hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700",disabled:l(s)<=0},[...t[3]||(t[3]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20 12H4"})],-1)])],8,J),p(l(O),{modelValue:l(s),"onUpdate:modelValue":t[0]||(t[0]=k=>_(s)?s.value=k:null),modelModifiers:{number:!0},type:"number",min:"0",class:"w-20 text-center",onInput:t[1]||(t[1]=k=>s.value=Math.max(0,parseInt(l(s))||0))},null,8,["modelValue"]),e("button",{onClick:o,class:"flex h-10 w-10 items-center justify-center rounded-lg border border-gray-300 transition-colors hover:bg-gray-100 dark:border-gray-600 dark:hover:bg-gray-700"},[...t[4]||(t[4]=[e("svg",{class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)])])])]),e("div",K,[e("div",W,[t[6]||(t[6]=e("span",null,"Unit Price:",-1)),e("span",null,"짜"+m(a.bag.price),1)]),e("div",X,[t[7]||(t[7]=e("span",null,"Quantity:",-1)),e("span",null,m(l(s))+" pieces",1)]),t[9]||(t[9]=e("hr",{class:"my-2 border-gray-200 dark:border-gray-600"},null,-1)),e("div",Z,[t[8]||(t[8]=e("span",null,"Total:",-1)),l(s)>0?(c(),g("span",ee," 짜"+m((a.bag.price*l(s)).toLocaleString()),1)):(c(),g("span",te,"짜0"))])]),e("div",ae,[p(l(D),{variant:"outline",class:"flex-1",onClick:f,disabled:l(d)},{default:V(()=>[...t[10]||(t[10]=[F(" Cancel ",-1)])]),_:1},8,["disabled"]),p(l(D),{class:"flex-1",onClick:u,disabled:l(d)||l(s)<=0},{default:V(()=>[l(d)?(c(),g("span",se,"Adding...")):(c(),g("span",ne,"Add to Cart"))]),_:1},8,["disabled"])])])])):C("",!0)}}};let x=null,v=null;const re=3600*1e3;async function j(){if(x&&v&&Date.now()-v<re)return x;try{const a=await fetch("https://api.exchangerate-api.com/v4/latest/CNY");if(!a.ok)throw new Error("Failed to fetch exchange rate");const n=(await a.json()).rates.USD,i=n<1?1/n:n;return x=i,v=Date.now(),i}catch(a){console.warn("Failed to fetch real-time exchange rate, using fallback rate:",a);const r=7.2;return x=r,v=Date.now(),r}}async function N(a){const r=await j();return Number((a/r).toFixed(2))}async function oe(a){return`$${await N(a)}`}function fe(){const a=b(null),r=b(!1),n=b(null),i=async()=>{if(!r.value){r.value=!0,n.value=null;try{const o=await j();a.value=o}catch(o){n.value=o instanceof Error?o.message:"Failed to fetch exchange rate",console.error("Exchange rate fetch error:",o)}finally{r.value=!1}}},s=async o=>await N(o),d=async o=>await oe(o),u=o=>a.value?Number((o/a.value).toFixed(2)):null,f=o=>{const y=u(o);return y?`$${y}`:null};return A(()=>{i()}),{exchangeRate:h(a),isLoading:h(r),error:h(n),fetchExchangeRate:i,convertToUSD:s,getUSDPrice:d,calculateUSDPrice:u,getFormattedUSDPriceSync:f}}export{ce as _,fe as u};
